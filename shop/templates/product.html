{% extends "base.html" %}
{% load cart_tags %}
{% block content %}
<section class="section">
  <div class="container">
    <div class="product">
      <header class="section__header">
        <div class="bread-crumps">
        {% autoescape off %}
          {{product.bread_crumps}}
        {% endautoescape %}
        </div>
        <h3>{{product.name}}</h3>
        <a href="#" class="link link--hover-color--none">
          <div class="rating">
          {% autoescape off %}
            {{product.get_middle_rating_as_html}}
          {% endautoescape %}
          </div>
        </a>
      </header>
      <div class="product__slider">
        <img class="product__main-img" src="{{product.first_image}}" alt="">
        <div class="product__img-list-container">
          <div class="product__img-list">
            <div class="product__img-container selected">
              <img class="product__img" src="{{product.first_image}}" alt="">
            </div>
            {% for image in product.after_first_image %}
            <div class="product__img-container">
              <img class="product__img" src="{{image}}" alt="">
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      <div>
        <h1 class="product__price">
          {{product.get_price}}
        </h1>
        <button class="button button--background--blue button--fullwidth product__cart-button">
          В корзину
          <span class="material-symbols-outlined icon icon--small icon--white product__button-icon">
            shopping_cart
          </span>
        </button>
        <button class="button" data-count-updater="favorite" data-count-updater-url="{{product.to_favorite_url}}" data-count-updater-method="changeFavorite">
          <span class="material-symbols-outlined icon icon--small product__padding-0-25rem {% if product in user.profile.favorite_products.all %}icon--blue{% else %}icon--gray{% endif %}">
            favorite
          </span>
          <span class="text">
            {% if product in user.profile.favorite_products.all %}В избранном{% else %}В избранное{% endif %}
          </span>
        </button>
        <button class="button" data-count-updater="compare" data-count-updater-url="{{product.to_compare_url}}" data-count-updater-method="changeCompare">
          <span class="material-symbols-outlined icon icon--small product__padding-0-25rem {% if product in user.profile.compare_products.all %}icon--blue{% else %}icon--gray{% endif %}">
            align_vertical_bottom
          </span>
          <span class="text">
            {% if product in user.profile.compare_products.all %}В сравнении{% else %}Добавить в сравнение{% endif %}
          </span>
        </button>
      </div>
      <hr>
      <div class="product__sku-info">
        <span class="product__sku">арт.</span> {{product.sku}}
      </div>
      <div>
        <div class="accordion">
          <div class="accordion__header">
            <h4 class="accordion__header-text"><span class="material-symbols-outlined icon accordion__header-icon">
              feed
              </span>Описание</h4>
            <span class="material-symbols-outlined icon accordion__expand-icon">
              expand_more
            </span>
          </div>
          <div class="accordion__content">
            <p>{{product.description}}</p>
          </div>
        </div>
        <hr>
        <div class="accordion">
          <div class="accordion__header">
            <h4 class="accordion__header-text"><span class="material-symbols-outlined icon accordion__header-icon">
              tune
              </span>Характеристики</h4>
            <span class="material-symbols-outlined icon accordion__expand-icon">
              expand_more
            </span>
          </div>
          <div class="accordion__content">
            {% for name, value in product.specifications.items %}
              <div class="specification">
                <div class="specification__name">{{name}}</div>
                <div class="specification__value">{{value}}</div>
              </div>
            {% endfor %}
          </div>
        </div>
        <hr>
        <div class="accordion">
          <div class="accordion__header">
            <h4 class="accordion__header-text"><span class="material-symbols-outlined icon accordion__header-icon">
              forum
              </span>Отзывы</h4>
            <span class="material-symbols-outlined icon accordion__expand-icon">
              expand_more
            </span>
          </div>
          <div class="accordion__content">
            <div class="review_list">
              {% for review in product.reviews.all %}
              {% empty %}
              <h3>Отзывов еще никто не оставлял</h3>
              {% endfor %}
            </div>
            
            <input id="review-form-active" type="checkbox">
            <button class="review-form-active-button button button--background--blue">
              <label for="review-form-active">Написать отзыв</label> 
            </button>
            <form class="review-form" action="" method="post">
              <div class="review-form__cancel">
                <label for="review-form-active">Отмена</label>
              </div>
              <div class="review-form__rating">
                <input class="review-form__rating-input" type="number" name="rating" required>
                <div>
                  <span class="material-symbols-outlined icon">
                    star
                  </span>
                  <span class="material-symbols-outlined icon">
                    star
                  </span>
                  <span class="material-symbols-outlined icon">
                    star
                  </span>
                  <span class="material-symbols-outlined icon">
                    star
                  </span>
                  <span class="material-symbols-outlined icon">
                    star
                  </span>
                </div>
              </div>
              <label class="input-label-required" for="review">Отзыв</label>
              <textarea id="review" placeholder="Отзыв" class="review-form__review" required></textarea>
              <button class="button button--background--blue button--fullwidth">Оставить отзыв</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{% endblock content %}